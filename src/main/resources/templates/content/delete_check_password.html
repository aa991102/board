<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" 
	xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	xmlns:decorate="~{layout/default_layout}">
	
	<th:block layout:fragment="head">
		<title>Board</title>
		
		<link rel="stylesheet" th:href="@{/css/board.css}"/>
		<script type="text/javascript" th:src="@{/js/jquery-3.6.0.min.js}"></script>
		<script type="text/javascript" th:src="@{/js/jquery.tmpl.js}"></script>
		<script type="text/javascript">
			$(function(){
				$('#submit-btn').click(function(){
					if(confirm("정말 삭제하시겠습니까?")){
						$.ajax({
						    url: '/boardDeleteCheck',
						    type: 'POST',
						    data: $('#delete-frm').serialize(),
						    success: function(data) {
						        console.log(data);
						        if(data == 'success'){
						        	$.ajax({
									    url: '/boardDelete/[[${board_no}]]',
									    type: 'POST',
									    success: function(data) {
									        console.log(data);
									        if(data == 'success'){
									        	location.href='/board';
									        }else{
									        	alert('오류가 발생했습니다. 잠시 후 다시 시도해주세요.');
									        }
									    },
									    error: function(error) {
									        console.error(error);
									    }
									});
						        }else{
						        	alert('비밀번호가 일치하지 않습니다.');
						        }
						    },
						    error: function(error) {
						        console.error(error);
						    }
						});
					}
				})
			})
		</script>
	</th:block>
	
	<body>
		<th:block layout:fragment="header" th:include="@{/fragments/header}"></th:block>
		
		<div layout:fragment="content" class="content">
			<form action="/boardDeleteCheck" method="post" id="delete-frm">
				<h2>글 삭제하기</h2>
				<table>
					<tr>
						<th>비밀번호</th>
						<td><input type="password" name="password"></td>
					</tr>
				</table>
				<input type="button" id="submit-btn" value="확인">
				<input type="hidden" name="board_no" th:value="${board_no}">
			</form>
		</div>
		
		<th:block layout:fragment="footer" th:include="@{/fragments/footer}"></th:block>
	</body>
</html>